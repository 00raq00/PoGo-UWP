<Page
    x:Class="PokemonGo_UWP.Views.SearchPokestopPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    DataContext="{Binding GameManagerViewModel, Source={StaticResource Locator}}"
    mc:Ignorable="d">

    <Page.Resources>

        <Storyboard x:Name="ShowGatheredItemsMenu">
            <DoubleAnimation
                Storyboard.TargetName="GatheredItemsTranslateTransform"
                Storyboard.TargetProperty="Y"
                From="500"
                To="150"
                Duration="0:0:0.2" />
        </Storyboard>

        <Storyboard x:Name="SpinPokestopImage"
                    SpeedRatio="5">
            <DoubleAnimationUsingKeyFrames
                Storyboard.TargetProperty="(UIElement.Projection).(PlaneProjection.RotationY)"
                Storyboard.TargetName="PokestopImageEllipse">
                <EasingDoubleKeyFrame KeyTime="0" Value="0" />
                <EasingDoubleKeyFrame KeyTime="0:0:10" Value="3600">
                    <EasingDoubleKeyFrame.EasingFunction>
                        <CubicEase EasingMode="EaseOut" />
                    </EasingDoubleKeyFrame.EasingFunction>
                </EasingDoubleKeyFrame>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
    </Page.Resources>

    <RelativePanel Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

        <Border x:Name="GatheredItemsBorder"
                RelativePanel.AlignLeftWithPanel="True"
                RelativePanel.AlignRightWithPanel="True"
                Background="AntiqueWhite"
                CornerRadius="8"
                Padding="8"
                Margin="8,0"
                Canvas.ZIndex="5">
            <Border.RenderTransform>
                <TranslateTransform x:Name="GatheredItemsTranslateTransform"
                                    Y="800" />
            </Border.RenderTransform>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Grid HorizontalAlignment="Center"
                      Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Image Source="../Assets/UI/gem.png"
                           Stretch="Uniform"
                           Width="48"
                           Grid.Column="0" />
                    <TextBlock Text="{Binding CurrentSearchResponse.GemsAwarded}"
                               Margin="24,0"
                               VerticalAlignment="Center"
                               Grid.Column="1" />
                    <TextBlock Text="XP"
                               Width="48"
                               VerticalAlignment="Center"
                               Grid.Column="2" />
                    <TextBlock Text="{Binding CurrentSearchResponse.ExperienceAwarded}"
                               Margin="24,0"
                               VerticalAlignment="Center"
                               Grid.Column="3" />
                </Grid>

                <ListView ItemsSource="{Binding CurrentSearchResponse.ItemsAwarded}"
                          SelectionMode="None"
                          Grid.Row="1"
                          HorizontalAlignment="Stretch">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="HorizontalContentAlignment"
                                    Value="Stretch" />
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="{Binding ItemId}"
                                           HorizontalAlignment="Left"
                                           Margin="0,6,0,0" />

                                <StackPanel Grid.Column="1"
                                            Orientation="Horizontal">
                                    <TextBlock Text="#"
                                               VerticalAlignment="Center" />
                                    <TextBlock Text="{Binding ItemCount}"
                                               HorizontalAlignment="Right"
                                               Margin="0,6,0,0" />
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <Grid Grid.Row="2"
                      Padding="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Image Source="../Assets/UI/egg.png"
                           Stretch="Uniform"
                           Width="48"
                           HorizontalAlignment="Left"
                           Grid.Column="0" />

                    <TextBlock Text="{Binding CurrentSearchResponse.PokemonDataEgg.PokemonId}"
                               HorizontalAlignment="Right"
                               Grid.Column="1" />
                </Grid>

                <Button Content="OK"
                        HorizontalAlignment="Stretch"
                        Command="{Binding ReturnToGameScreen}"
                        Grid.Row="3" />
            </Grid>
        </Border>

        <TextBlock Text="{Binding CurrentPokestopInfo.Name}"
                   RelativePanel.AlignHorizontalCenterWithPanel="True"
                   RelativePanel.AlignTopWithPanel="True"
                   TextAlignment="Left"
                   Margin="24" />

        <Button Style="{ThemeResource ImageButtonStyle}"
                RelativePanel.AlignHorizontalCenterWithPanel="True"
                RelativePanel.AlignVerticalCenterWithPanel="True"
                Height="256"
                Width="256"
                Command="{Binding SearchCurrentPokestop}"
                x:Name="SearchPokestopButton">
            <Ellipse x:Name="PokestopImageEllipse"
                     RelativePanel.AlignHorizontalCenterWithPanel="True"
                     RelativePanel.AlignVerticalCenterWithPanel="True"
                     Height="256"
                     Width="256"
                     Stroke="Blue"
                     StrokeThickness="10">
                <Ellipse.Projection>
                    <PlaneProjection />
                </Ellipse.Projection>
                <Ellipse.Fill>
                    <ImageBrush ImageSource="{Binding CurrentPokestopInfo.ImageUrls[0]}"
                                Stretch="UniformToFill" />
                </Ellipse.Fill>
            </Ellipse>
        </Button>

        <TextBlock Text="out of range"
                   RelativePanel.AlignHorizontalCenterWithPanel="True"
                   RelativePanel.AlignBottomWithPanel="True"
                   TextAlignment="Center"
                   Margin="24"
                   Visibility="Collapsed"
                   x:Name="OutOfRangeTextBlock" />

        <TextBlock Text="cooldown"
                   RelativePanel.AlignHorizontalCenterWithPanel="True"
                   RelativePanel.AlignBottomWithPanel="True"
                   TextAlignment="Center"
                   Margin="24"
                   Visibility="Collapsed"
                   x:Name="CooldownTextBlock" />

        <TextBlock Text="inventory full"
                   RelativePanel.AlignHorizontalCenterWithPanel="True"
                   RelativePanel.AlignBottomWithPanel="True"
                   TextAlignment="Center"
                   Margin="24"
                   Visibility="Collapsed"
                   x:Name="InventoryFulleTextBlock" />

    </RelativePanel>
</Page>