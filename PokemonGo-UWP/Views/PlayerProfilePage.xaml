<Page
    x:Class="PokemonGo_UWP.Views.PlayerProfilePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:PokemonGo_UWP.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="using:PokemonGo_UWP.ViewModels"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
    mc:Ignorable="d">

    <Page.DataContext>
        <viewModels:PlayerProfileViewModel x:Name="ViewModel" />
    </Page.DataContext>

    <Page.Resources>
        <Storyboard x:Name="ShowSortMenuStoryboard">

            <DoubleAnimation
                Storyboard.TargetName="SortMenuPanel"
                Storyboard.TargetProperty="Opacity"
                From="0"
                To="1"
                Duration="0:0:0.2" />

            <DoubleAnimation
                Storyboard.TargetName="MainUIPanel"
                Storyboard.TargetProperty="Opacity"
                From="1"
                To="0"
                Duration="0:0:0.2" />

            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Canvas.ZIndex)"
                                           Storyboard.TargetName="SortMenuPanel">
                <DiscreteObjectKeyFrame KeyTime="0">
                    <DiscreteObjectKeyFrame.Value>
                        <x:Int32>0</x:Int32>
                    </DiscreteObjectKeyFrame.Value>
                </DiscreteObjectKeyFrame>
                <DiscreteObjectKeyFrame KeyTime="0:0:0.2">
                    <DiscreteObjectKeyFrame.Value>
                        <x:Int32>10</x:Int32>
                    </DiscreteObjectKeyFrame.Value>
                </DiscreteObjectKeyFrame>
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Name="HideSortMenuStoryboard">
            <DoubleAnimation
                Storyboard.TargetName="SortMenuPanel"
                Storyboard.TargetProperty="Opacity"
                From="1"
                To="0"
                Duration="0:0:0.2" />

            <DoubleAnimation
                Storyboard.TargetName="MainUIPanel"
                Storyboard.TargetProperty="Opacity"
                From="0"
                To="1"
                Duration="0:0:0.2" />

            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Canvas.ZIndex)"
                                           Storyboard.TargetName="SortMenuPanel">
                <DiscreteObjectKeyFrame KeyTime="0">
                    <DiscreteObjectKeyFrame.Value>
                        <x:Int32>10</x:Int32>
                    </DiscreteObjectKeyFrame.Value>
                </DiscreteObjectKeyFrame>
                <DiscreteObjectKeyFrame KeyTime="0:0:0.2">
                    <DiscreteObjectKeyFrame.Value>
                        <x:Int32>0</x:Int32>
                    </DiscreteObjectKeyFrame.Value>
                </DiscreteObjectKeyFrame>
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

    </Page.Resources>

    <Grid HorizontalAlignment="Stretch"
          VerticalAlignment="Stretch">
        <RelativePanel x:Name="MainUIPanel"
                       HorizontalAlignment="Stretch"
                       VerticalAlignment="Stretch">

            <RelativePanel.Background>
                <ImageBrush ImageSource="../Assets/UI/panelBG.png"
                            Stretch="Uniform" />
            </RelativePanel.Background>

            <RelativePanel x:Name="UserDetailsPanel"
                           RelativePanel.AlignTopWithPanel="True"
                           RelativePanel.Above="CloseButton"
                           RelativePanel.AlignLeftWithPanel="True"
                           RelativePanel.AlignRightWithPanel="True"
                           Padding="10"
                           Grid.Column="0"
                           VerticalAlignment="Stretch">
                
                <TextBlock Text="{Binding PlayerProfile.Username}"
                           x:Name="UsernameTextBlock"
                           FontSize="30"
                           RelativePanel.AlignTopWithPanel="True"
                           Foreground="{ThemeResource ContrastColorBrush}" />
                <Ellipse Width="64"
                         Height="64"
                         Stroke="{Binding PlayerProfile.Team, Converter={StaticResource PlayerTeamToTeamColorBrushConverter}}"
                         RelativePanel.Below="UsernameTextBlock"
                         StrokeThickness="2.5"
                         x:Name="AvatarEllipse">
                    <Ellipse.Fill>
                        <ImageBrush ImageSource="../Assets/UI/avatar.png" />
                    </Ellipse.Fill>
                </Ellipse>

                <ProgressBar Value="{Binding ExperienceValue}"
                             Foreground="{Binding PlayerProfile.Team, Converter={StaticResource PlayerTeamToTeamColorBrushConverter}}"
                             Height="5"
                             Margin="0,-5,0,0"
                             RelativePanel.AlignLeftWithPanel="True"
                             RelativePanel.AlignRightWithPanel="True"
                             RelativePanel.Below="AvatarEllipse"
                             x:Name="ExperienceProgressBar" />

                <StackPanel RelativePanel.RightOf="AvatarEllipse"
                            RelativePanel.Above="ExperienceProgressBar"
                            Orientation="Horizontal">
                    <TextBlock Text="Level"
                               FontSize="38"
                               Foreground="{ThemeResource ContrastColorBrush}"
                               Style="{ThemeResource BodyTextBlockStyle}"
                               x:Uid="LevelText"
                               FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding PlayerStats.Level}"
                               Margin="5,0,0,0"
                               FontSize="38"
                               Foreground="{ThemeResource ContrastColorBrush}"
                               Style="{ThemeResource BodyTextBlockStyle}"
                               FontWeight="SemiBold"/>
                </StackPanel>

                <TextBlock Text="{Binding ExperienceString}"
                           x:Name="ExperienceText"
                           RelativePanel.Below="ExperienceProgressBar"/>

                <ListView RelativePanel.Below="ExperienceText"
                          RelativePanel.AlignBottomWithPanel="True"
                          RelativePanel.AlignLeftWithPanel="True"
                          RelativePanel.AlignRightWithPanel="True"
                          ItemsSource="{Binding PlayerStatsValues}"
                          SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Value}"/>
                                <TextBlock Text="{Binding Key, Converter={StaticResource PlayerStatsTranslationConverter}}"
                                           Margin="5,0,0,0"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </RelativePanel>
            
            <Button RelativePanel.AlignBottomWithPanel="True"
                    RelativePanel.AlignHorizontalCenterWithPanel="True"
                    Style="{ThemeResource ImageButtonStyle}"
                    Height="{ThemeResource UiButtonSize}"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    Margin="0,0,0,24"
                    Command="{Binding ReturnToGameScreen}"
                    x:Name="CloseButton">
                <Image Source="../Assets/Buttons/btn_close_normal_dark.png"
                       Stretch="Uniform"
                       HorizontalAlignment="Stretch" />
            </Button>
        </RelativePanel>

    </Grid>

</Page>